name: Handle Member Addition Request

on:
  issues:
    types: [opened]

jobs:
  handle-add-member:
    runs-on: ubuntu-latest
    permissions:
      issues: write  # éœ€è¦å†™æƒé™æ¥æ‰“æ ‡ç­¾å’Œè¯„è®º
    steps:
      - name: Detect and tag member addition request
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.payload.issue;
            const number = issue.number;
            const title = issue.title || '';
            const body = issue.body || '';
            const content = (title + '\n' + body).toLowerCase();

            // æ£€æŸ¥æ˜¯å¦åŒ…å« "-æ·»åŠ æˆå‘˜-"ï¼ˆä¸åŒºåˆ†å¤§å°å†™æˆ–æ ¼å¼å®½æ¾ï¼‰
            if (content.includes('-æ·»åŠ æˆå‘˜-')) {
              // 1. æ·»åŠ  add-contributor æ ‡ç­¾
              await github.rest.issues.addLabels({
                issue_number: number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                labels: ['add-contributor']
              });

              // 2. è‡ªåŠ¨è¯„è®ºç­‰å¾…å®¡æ ¸
              await github.rest.issues.createComment({
                issue_number: number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                body: `ğŸ“¬ æ”¶åˆ°ä½ çš„ç”³è¯·ï¼\n\næ­£åœ¨ç­‰å¾…ç®¡ç†å‘˜å®¡æ ¸ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚ç®¡ç†å‘˜å°†é€šè¿‡æ·»åŠ  \`approved\` æ ‡ç­¾æ¥æ‰¹å‡†æ­¤è¯·æ±‚ã€‚`
              });

              console.log('âœ… å·²è‡ªåŠ¨æ ‡è®°ä¸ºè´¡çŒ®è€…ç”³è¯·å¹¶è¯„è®º');
            } else {
              console.log('â­ï¸ ä¸æ˜¯æˆå‘˜æ·»åŠ è¯·æ±‚ï¼Œè·³è¿‡ã€‚');
            }
